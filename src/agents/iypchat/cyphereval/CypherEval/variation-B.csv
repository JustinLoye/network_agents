"Task ID","Difficulty Level","Prompt","Canonical Solution"
"1.1","Easy technical prompt","Find the distinct IXPs' names of which the AS with asn 8075 is member of.","MATCH (:AS {asn: 8075})-[:MEMBER_OF]->(ixp:IXP) RETURN DISTINCT ixp.name"
"1.2","Easy general prompt","Give me the names of the IXPs where AS8075 is a member.","MATCH (:AS {asn: 8075})-[:MEMBER_OF]->(ixp:IXP) RETURN DISTINCT ixp.name"
"2.1","Easy technical prompt","Find the percentage of the population for the Country with country_code 'US' hosted by the AS with asn 8075.","MATCH (:AS {asn:8075})-[p:POPULATION]-(:Country {country_code:'US'}) RETURN p.percent"
"2.2","Easy general prompt","Find the percentage of United States' population covered by AS8075.","MATCH (:AS {asn:8075})-[p:POPULATION]-(:Country {country_code:'US'}) RETURN p.percent"
"3.1","Medium technical prompt","Find rank numbers and the corresponding rank names for the AS with asn 8075 in the Country with country_code 'US'.","MATCH (:AS  {asn:8075})-[r1:RANK]-(r2:Ranking)--(:Country {country_code:'US'}) RETURN r1.rank, r2.name"
"3.2","Medium general prompt","Find ranks and the corresponding rank names of AS8075 in the United States.","MATCH (:AS {asn:8075})-[r1:RANK]-(r2:Ranking)--(:Country {country_code:'US'}) RETURN r1.rank, r2.name"
"4.1","Hard technical prompt","Find all the AS nodes that have a peer to peer relationship with the AS with asn 8075.","MATCH (:AS {asn:8075})-[:PEERS_WITH {rel: 0}]-(a:AS) RETURN a"
"4.2","Hard general prompt","Find the ASes that are peering with AS8075.","MATCH (:AS {asn:8075})-[:PEERS_WITH]-(a:AS) RETURN a"
"5.1","Easy technical prompt","Find the distinct names of the AS with asn 8075.","MATCH (:AS {asn:8075})-[:NAME]-(n:Name) RETURN DISTINCT n.name"
"5.2","Easy general prompt","Give me the names of AS8075.","MATCH (:AS {asn:8075})-[:NAME]-(n:Name) RETURN DISTINCT n.name"
"6.1","Easy technical prompt","Find all distinct tag labels of the AS with asn 8075.","MATCH (:AS {asn:8075})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"6.2","Easy general prompt","Find the tags of AS8075.","MATCH (:AS {asn:8075})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"7.1","Easy technical prompt","Find all distinct tag labels of the Prefix with prefix 206.191.224.0/19.","MATCH (:Prefix {prefix: '206.191.224.0/19'})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"7.2","Easy general prompt","Find the tags of 206.191.224.0/19.","MATCH (:Prefix {prefix: '206.191.224.0/19'})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"8.1","Medium technical prompt","Find the rank number for the AS with asn 8075 in the Ranking with name 'CAIDA ASRank'.","MATCH (:AS  {asn:8075})-[r:RANK]-(:Ranking {name:'CAIDA ASRank'}) RETURN r.rank"
"8.2","Medium general prompt","Find the CAIDA AS rank for AS8075.","MATCH (:AS {asn:8075})-[r:RANK]-(:Ranking {name:'CAIDA ASRank'}) RETURN r.rank"
"9.1","Medium technical prompt","Find the rank number for the DomainName with name 'iij.ad.jp' in the Ranking with name 'Cisco Umbrella Top 1 million'.","MATCH (:DomainName {name: 'iij.ad.jp'})-[r:RANK]-(:Ranking {name:'Cisco Umbrella Top 1 million'}) RETURN r.rank"
"9.2","Medium general prompt","Find the rank for 'iij.ad.jp' in the 'Cisco Umbrella Top 1 million' list.","MATCH (:DomainName {name: 'iij.ad.jp'})-[r:RANK]-(:Ranking {name:'Cisco Umbrella Top 1 million'}) RETURN r.rank"
"10.1","Medium technical prompt","Find the rank number for the HostName with name 'www.cisco.com' in the Ranking with name 'Cisco Umbrella Top 1 million'.","MATCH (:HostName {name: 'www.cisco.com'})-[r:RANK]-(:Ranking {name:'Cisco Umbrella Top 1 million'}) RETURN r.rank"
"10.2","Medium general prompt","Find the rank for 'www.cisco.com' in the 'Cisco Umbrella Top 1 million' list.","MATCH (:HostName {name: 'www.cisco.com'})-[r:RANK]-(:Ranking {name:'Cisco Umbrella Top 1 million'}) RETURN r.rank"
"11.1","Easy technical prompt","Find all distinct tag labels of the URL with url 'https://www.aliexpress.com/'.","MATCH (:URL {url: 'https://www.aliexpress.com/'})-[:CATEGORIZED]->(t:Tag) RETURN DISTINCT t.label"
"11.2","Easy general prompt","Find the tags of 'https://www.aliexpress.com/'.","MATCH (:URL {url: 'https://www.aliexpress.com/'})-[:CATEGORIZED]->(t:Tag) RETURN DISTINCT t.label"
"12.1","Medium technical prompt","Find the value of QUERIED_FROM for the DomainName with name 'microsoft.com' in the Country with country_code 'JP'.","MATCH (:DomainName {name: 'microsoft.com'})-[q:QUERIED_FROM]->(:Country {country_code: 'JP'}) RETURN q.value"
"12.2","Medium general prompt","How many times was 'microsoft.com' queried from Japan?","MATCH (:DomainName {name: 'microsoft.com'})-[q:QUERIED_FROM]->(:Country {country_code: 'JP'}) RETURN q.value"
"13.1","Medium technical prompt","Find the value of QUERIED_FROM for the DomainName with name 'microsoft.com' from the AS with asn 577.","MATCH (:DomainName {name: 'microsoft.com'})-[q:QUERIED_FROM]->(a:AS {asn: 577}) RETURN q.value"
"13.2","Medium general prompt","How many times was 'microsoft.com' queried from AS577?","MATCH (:DomainName {name: 'microsoft.com'})-[q:QUERIED_FROM]->(a:AS {asn: 577}) RETURN q.value"
"14.1","Easy technical prompt","Find the distinct AS' asn of the ASes with name 'Microsoft'.","MATCH (a:AS)-[:NAME]-(:Name {name: 'Microsoft'}) RETURN DISTINCT a.asn"
"14.2","Easy general prompt","Find Microsoft's AS numbers.","MATCH (a:AS)-[:NAME]-(:Name {name: 'Microsoft'}) RETURN DISTINCT a.asn"
"15.1","Easy technical prompt","Find the distinct AuthoritativeNameServer's names that manage the DomainName with name 'com'.","MATCH (:DomainName {name: 'com'})-[:MANAGED_BY]->(a:AuthoritativeNameServer) RETURN DISTINCT a.name"
"15.2","Easy general prompt","Who manages the 'com' domain?","MATCH (:DomainName {name: 'com'})-[:MANAGED_BY]->(a:AuthoritativeNameServer) RETURN DISTINCT a.name"
"16.1","Hard technical prompt","Find the distinct AuthoritativeNameServer's names that manage the IP with ip 72.163.5.201.","MATCH (a:AuthoritativeNameServer)<-[:MANAGED_BY]-(:DomainName)<-[:PART_OF]-(:HostName)-[:RESOLVES_TO]->(:IP {ip: '72.163.5.201'}) RETURN DISTINCT a.name"
"16.2","Hard general prompt","Who manages DNS for the IP address 72.163.5.201?","MATCH (a:AuthoritativeNameServer)<-[:MANAGED_BY]-(:DomainName)<-[:PART_OF]-(:HostName)-[:RESOLVES_TO]->(:IP {ip: '72.163.5.201'}) RETURN DISTINCT a.name"
"17.1","Easy technical prompt","Find the hege values of the AS with asn 109 that depends on the AS with asn 3356.","MATCH (:AS {asn: 109})-[d:DEPENDS_ON]->(:AS {asn: 3356}) RETURN d.hege"
"17.2","Easy general prompt","Find the AS hegemony value from AS109 to AS3356.","MATCH (:AS {asn: 109})-[d:DEPENDS_ON]->(:AS {asn: 3356}) RETURN d.hege"
"18.1","Hard technical prompt","Find the AS' asn on which United States (Country with country_code 'US') depends the most according to the Ranking with name 'IHR country ranking: Total AS (US)'.","MATCH (a:AS)-[r:RANK]->(:Ranking {name: 'IHR country ranking: Total AS (US)'})-[:COUNTRY]->(:Country {country_code: 'US'}) RETURN a.asn ORDER BY r.hege DESC LIMIT 1"
"18.2","Hard general prompt","On which AS does the United States depend on the most?","MATCH (a:AS)-[r:RANK]->(:Ranking {name: 'IHR country ranking: Total AS (US)'})-[:COUNTRY]->(:Country {country_code: 'US'}) RETURN a.asn ORDER BY r.hege DESC LIMIT 1"
"19.1","Easy technical prompt","Find the Prefix's prefixes that originate from the AS with asn 109.","MATCH (p:Prefix)<-[:ORIGINATE]-(:AS {asn: 109}) RETURN p.prefix"
"19.2","Easy general prompt","Find the originated prefixes of AS109.","MATCH (p:Prefix)<-[:ORIGINATE]-(:AS {asn: 109}) RETURN p.prefix"
"20.1","Easy technical prompt","Find the distinct Prefix's prefixes that depend on the AS with asn 109.","MATCH (p:Prefix)-[:DEPENDS_ON]->(:AS {asn: 109}) RETURN DISTINCT p.prefix"
"20.2","Easy general prompt","Find the prefixes depending on AS109.","MATCH (p:Prefix)-[:DEPENDS_ON]->(:AS {asn: 109}) RETURN DISTINCT p.prefix"
"21.1","Easy technical prompt","Find the distinct Prefix's prefixes that are categorized with the Tag with label 'Anycast'.","MATCH (p:Prefix)-[:CATEGORIZED]->(:Tag {label: 'Anycast'}) RETURN DISTINCT p.prefix"
"21.2","Easy general prompt","Give me anycast prefixes.","MATCH (p:Prefix)-[:CATEGORIZED]->(:Tag {label: 'Anycast'}) RETURN DISTINCT p.prefix"
"22.1","Easy technical prompt","Find the distinct Prefix's prefixes from Country with country_code 'US'.","MATCH (p:Prefix)-[:COUNTRY]->(:Country {country_code: 'US'}) RETURN DISTINCT p.prefix"
"22.2","Easy general prompt","Find prefixes locaed in the United States.","MATCH (p:Prefix)-[:COUNTRY]->(:Country {country_code: 'US'}) RETURN DISTINCT p.prefix"
"23.1","Easy technical prompt","From AS with asn 109 find all the AS siblings and return their asn.","MATCH (:AS {asn: 109})-[:SIBLING_OF]-(a:AS) RETURN a.asn"
"23.2","Easy general prompt","Find siblings of AS109.","MATCH (:AS {asn: 109})-[:SIBLING_OF]-(a:AS) RETURN a.asn"
"24.1","Easy technical prompt","Find the distinct IP's ips which HostName with name 'microsoft.com' resolves to.","MATCH (:HostName {name: 'microsoft.com'})-[:RESOLVES_TO]->(i:IP) RETURN DISTINCT i.ip"
"24.2","Easy general prompt","Which IPs does 'microsoft.com' resolve to?","MATCH (:HostName {name: 'microsoft.com'})-[:RESOLVES_TO]->(i:IP) RETURN DISTINCT i.ip"
"25.1","Medium technical prompt","Find the AS' asn which is the target of AtlasMeasurement with id 6907267 which the AtlasProbe with id 1004379 is part of.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 6907267})-[:TARGET]->(a:AS) RETURN a.asn"
"25.2","Medium general prompt","Find the ASes that are targeted by the Atlas measurement with ID 6907267. The Atlas probe with ID 1004379 participates in this measurement.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 6907267})-[:TARGET]->(a:AS) RETURN a.asn"
"26.1","Medium technical prompt","Find the HostName's name which is the target of AtlasMeasurement with id 69298464 which the AtlasProbe with id 1004379 is part of.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 69298464})-[:TARGET]->(h:HostName) RETURN h.name"
"26.2","Medium general prompt","Find the hostnames that are targeted by the Atlas measurement with ID 69298464. The Atlas probe with ID 1004379 participates in this measurement.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 69298464})-[:TARGET]->(h:HostName) RETURN h.name"
"27.1","Medium technical prompt","Find the IP's ip which is the target of AtlasMeasurement with id 6907267 which the AtlasProbe with id 1004379 is part of.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 6907267})-[:TARGET]->(i:IP) RETURN i.ip"
"27.2","Medium general prompt","Find the IPs that are targeted by the Atlas measurement with ID 6907267. The Atlas probe with ID 1004379 participates in this measurement.","MATCH (:AtlasProbe {id: 1004379})-[:PART_OF]->(:AtlasMeasurement {id: 6907267})-[:TARGET]->(i:IP) RETURN i.ip"
"28.1","Easy technical prompt","Return the id of the OpaqueID which marks the Prefix with prefix 156.0.199.0/24 as available.","MATCH (:Prefix {prefix: '156.0.199.0/24'})-[:AVAILABLE]->(o:OpaqueID) RETURN o.id"
"28.2","Easy general prompt","Find the opaque id of 156.0.199.0/24.","MATCH (:Prefix {prefix: '156.0.199.0/24'})-[:AVAILABLE]->(o:OpaqueID) RETURN o.id"
"29.1","Easy technical prompt","Find all the distinct Tag labels that categorize the ASN with asn 109.","MATCH (:AS {asn:109})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"29.2","Easy general prompt","Find tags for AS109.","MATCH (:AS {asn:109})-[:CATEGORIZED]-(t:Tag) RETURN DISTINCT t.label"
"30.1","Easy technical prompt","From the Ranking with name 'Cloudflare top 100 domains' find the DomainName's name that is ranked first.","MATCH (d:DomainName)-[:RANK {rank: 1}]->(:Ranking {name: 'Cloudflare top 100 domains'}) RETURN d.name"
"30.2","Easy general prompt","Find the top domain name in the 'Cloudflare top 100 domains' list.","MATCH (d:DomainName)-[:RANK {rank: 1}]->(:Ranking {name: 'Cloudflare top 100 domains'}) RETURN d.name"
"31.1","Easy technical prompt","Find the population value for Country United States with country_code 'US'.","MATCH (:Country {country_code: 'US'})-[p:POPULATION]-() RETURN p.value"
"31.2","Easy general prompt","Find the population of the United States.","MATCH (:Country {country_code: 'US'})-[p:POPULATION]-() RETURN p.value"
"32.1","Medium technical prompt","Count the distinct ASes in the Country with country_code 'JP' or 'US'.","MATCH (a:AS)-[:COUNTRY]-(cc:Country) WHERE cc.country_code = 'JP' OR cc.country_code = 'US' WITH cc.country_code AS code, count(DISTINCT a) AS c RETURN c"
"32.2","Medium general prompt","Count the ASes in Japan and the United States.","MATCH (a:AS)-[:COUNTRY]-(cc:Country) WHERE cc.country_code = 'JP' OR cc.country_code = 'US' WITH cc.country_code AS code, count(DISTINCT a) AS c RETURN c"
"33.1","Medium technical prompt","Find the total number of distinct ASes that originate a prefix in the Country with country_code 'JP'","MATCH (:Country {country_code: 'JP'})-[:COUNTRY]-(as:AS)-[:ORIGINATE]-(:Prefix) RETURN count(DISTINCT as) AS totalASWithPrefix"
"33.2","Medium general prompt","Count ASes in Japan that originate prefixes.","MATCH (:Country {country_code: 'JP'})-[:COUNTRY]-(as:AS)-[:ORIGINATE]-(:Prefix) RETURN count(DISTINCT as) AS totalASWithPrefix"
"34.1","Easy technical prompt","Find all Facility nodes in which both the AS with asn 1233 and the AS with asn 2497 are located.","MATCH (a:AS {asn: 1233})--(fac:Facility)--(b:AS {asn: 2497}) RETURN fac"
"34.2","Easy general prompt","Find co-location facilities of AS1233 and AS2497.","MATCH (a:AS {asn: 1233})--(fac:Facility)--(b:AS {asn: 2497}) RETURN fac"
"35.1","Medium technical prompt","Find the distinct Country's country codes for all the Facilities in which the AS with asn 1233 and the AS with asn 2497 are located.","MATCH (:AS {asn: 1233})--(fac:Facility)--(:AS {asn: 2497}) MATCH (fac)--(cc:Country) RETURN DISTINCT(cc.country_code)"
"35.2","Medium general prompt","Find the country codes for all co-location facilities of AS1233 and AS2497.","MATCH (:AS {asn: 1233})--(fac:Facility)--(:AS {asn: 2497}) MATCH (fac)--(cc:Country) RETURN DISTINCT(cc.country_code)"
"36.1","Hard technical prompt","Find all distinct Country's country codes for all ASes connected to the OpaqueID that is assigned to the AS with asn 1233 or the AS with asn 2497.","MATCH (a:AS)-[:ASSIGNED]-(oid:OpaqueID) WHERE a.asn IN [1233, 2497] WITH oid MATCH (oid)--(other:AS)--(cc:Country) RETURN DISTINCT cc.country_code"
"36.2","Hard general prompt","Find the country codes for all ASes assigned to the same OpaqueID as AS1233 or AS2497.","MATCH (a:AS)-[:ASSIGNED]-(oid:OpaqueID) WHERE a.asn IN [1233, 2497] WITH oid MATCH (oid)--(other:AS)--(cc:Country) RETURN DISTINCT cc.country_code"
"37.1","Medium technical prompt","Find the nodes that have relationships to the Prefix with prefix 1.1.1.0/24. Do not take account the direction of the relationship.","MATCH (:Prefix {prefix:'1.1.1.0/24'})--(neighbor) RETURN neighbor"
"37.2","Medium general prompt","Return everything that is connected with 1.1.1.0/24.","MATCH (:Prefix {prefix:'1.1.1.0/24'})--(neighbor) RETURN neighbor"
"38.1","Hard technical prompt","Find distinct Country's country_codes that connect via a relationship with reference_name 'nro.delegated_stats' to the AS with asn 109.","MATCH (:AS {asn:109})-[{reference_name:'nro.delegated_stats'}]-(cc:Country) RETURN DISTINCT cc.country_code"
"38.2","Hard general prompt","Find the country codes for the countries in which AS109 is registered according to the NRO delegated stats.","MATCH (:AS {asn:109})-[{reference_name:'nro.delegated_stats'}]-(cc:Country) RETURN DISTINCT cc.country_code"
"39.1","Medium technical prompt","Find IXP nodes where the AS with asn 109 is member of together with their corresponding Country node.","MATCH (iij:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix, cc"
"39.2","Medium general prompt","Find IXP nodes and their respective country nodes for IXPs of which AS109 is a member.","MATCH (iij:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix, cc"
"40.1","Hard technical prompt","Find all the DomainName nodes with a rank below or equal 50000 that resolve to an IP originated by the AS with asn 109.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(iij:AS {asn:109}) WHERE r.rank <= 50000 RETURN dn"
"40.2","Hard general prompt","Retrieve domain name nodes in the top 50000 associated with IP addresses of AS109.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(iij:AS {asn:109}) WHERE r.rank <= 50000 RETURN dn"
"41.1","Easy technical prompt","Find all the Facility nodes that are located in the Country with country_code 'JP' or 'US' and return the Facility node with a count of distinct AS nodes per facility in descending order of the count.","MATCH (c:Country)--(f:Facility)--(a:AS) WHERE c.country_code = 'JP' OR c.country_code = 'US' RETURN f, count(DISTINCT a) AS nb_as ORDER BY nb_as DESC"
"41.2","Easy general prompt","Get all facilities in Japan or United States and count the number of unique ASes per facility. Order the result by descending number of unique ASes.","MATCH (c:Country)--(f:Facility)--(a:AS) WHERE c.country_code = 'JP' OR c.country_code = 'US' RETURN f, count(DISTINCT a) AS nb_as ORDER BY nb_as DESC"
"42.1","Medium technical prompt","Find the country_code of Facility nodes in which the AS with Country country_code 'JP' connected by relationship with reference_org 'NRO' are located and return the facility country_code and number of distinct ASes in descending order by number of distinct ASes.","MATCH (net_country:Country)-[:COUNTRY {reference_org:'NRO'}]-(net:AS)-[:LOCATED_IN]-(fac:Facility)--(fac_country:Country) WHERE net_country.country_code = 'JP' RETURN fac_country.country_code, count(DISTINCT net) AS nb_AS ORDER BY nb_AS DESC"
"42.2","Medium general prompt","Find the country codes of facilities that host Japanese ASes as specified by NRO and return the number of ASes per country. Order the result by descending number of ASes per country.","MATCH (net_country:Country)-[:COUNTRY {reference_org:'NRO'}]-(net:AS)-[:LOCATED_IN]-(fac:Facility)--(fac_country:Country) WHERE net_country.country_code = 'JP' RETURN fac_country.country_code, count(DISTINCT net) AS nb_AS ORDER BY nb_AS DESC"
"43.1","Medium technical prompt","Find the AS in the Country with country_code 'JP' or 'US' that is located in the largest number of facilities and return the asn and number of facilities.","MATCH (net_country:Country)-[:COUNTRY {reference_org:'NRO'}]-(net:AS)-[:LOCATED_IN]-(fac:Facility) WHERE net_country.country_code = 'JP' OR net_country.country_code = 'US' RETURN net.asn, count(DISTINCT fac) AS nb_fac ORDER BY nb_fac DESC LIMIT 1"
"43.2","Medium general prompt","Retrieve the ASN that is present at the largest number of facilities in Japan or United States. Also return the number of facilities.","MATCH (net_country:Country)-[:COUNTRY {reference_org:'NRO'}]-(net:AS)-[:LOCATED_IN]-(fac:Facility) WHERE net_country.country_code = 'JP' OR net_country.country_code = 'US' RETURN net.asn, count(DISTINCT fac) AS nb_fac ORDER BY nb_fac DESC LIMIT 1"
"44.1","Medium technical prompt","Find the Country's country_code of the Prefix nodes that originated from AS nodes located in Country with country_code 'JP'.","MATCH (net_country:Country)-[:COUNTRY]-(net:AS)-[:ORIGINATE]-(pfx:Prefix)-[:COUNTRY]-(pfx_country:Country) WHERE net_country.country_code = 'JP' RETURN pfx_country.country_code"
"44.2","Medium general prompt","Get the geolocation of prefixes announced by Japanese ASes.","MATCH (net_country:Country)-[:COUNTRY]-(net:AS)-[:ORIGINATE]-(pfx:Prefix)-[:COUNTRY]-(pfx_country:Country) WHERE net_country.country_code = 'JP' RETURN pfx_country.country_code"
"45.1","Medium technical prompt","Find the distinct Country's country_code of the Prefix nodes that originated from AS nodes located in the Country with country_code 'JP'.","MATCH (net_country:Country)-[:COUNTRY]-(net:AS)-[:ORIGINATE]-(pfx:Prefix)-[:COUNTRY]-(pfx_country:Country) WHERE net_country.country_code = 'JP' RETURN DISTINCT pfx_country.country_code"
"45.2","Medium general prompt","Get the country codes of prefixes announced by ASes in Japan.","MATCH (net_country:Country)-[:COUNTRY]-(net:AS)-[:ORIGINATE]-(pfx:Prefix)-[:COUNTRY]-(pfx_country:Country) WHERE net_country.country_code = 'JP' RETURN DISTINCT pfx_country.country_code"
"46.1","Medium technical prompt","Find the asn of the AS node with the largest number of Prefix nodes in Country with country_code 'JP' or 'US' and return the asn and the number of prefixes.","MATCH (net:AS)-[:ORIGINATE]-(pfx:Prefix)--(pfx_country:Country) WHERE pfx_country.country_code = 'JP' OR pfx_country.country_code = 'US' RETURN net.asn, COUNT(DISTINCT pfx) as pfx_count ORDER BY pfx_count DESC LIMIT 1"
"46.2","Medium general prompt","Get the ASN with the largest footprint in Japan or United States.","MATCH (net:AS)-[:ORIGINATE]-(pfx:Prefix)--(pfx_country:Country) WHERE pfx_country.country_code = 'JP' OR pfx_country.country_code = 'US' RETURN net.asn, COUNT(DISTINCT pfx) as pfx_count ORDER BY pfx_count DESC LIMIT 1"
"47.1","Medium technical prompt","Find a graph which shows the HostName nodes, the IP nodes, the Prefix nodes and the AS nodes of all the HostName nodes with name which it ends with '.jp'. Also, the HostName nodes should have rank below 10000.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.jp' AND r.rank<10000 RETURN dn.name, ip.ip, pfx.prefix, net.asn"
"47.2","Medium general prompt","Get a graph of the host name distribution of the Japanese host name.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.jp' AND r.rank<10000 RETURN dn.name, ip.ip, pfx.prefix, net.asn"
"48.1","Medium technical prompt","Find the AS nodes that contains HostName nodes with name ending in '.jp' and a rank below or equal 1000000. Return the asn and also the total number of the HostName nodes in descending order.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.jp' AND r.rank <= 100000 RETURN net.asn,  count(DISTINCT dn) AS nb_domain_name ORDER BY nb_domain_name DESC"
"48.2","Medium general prompt","Get ASNs that host the top 1 milion Japanese host names and return them in descending order of the number of host names.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.jp' AND r.rank <= 100000 RETURN net.asn, count(DISTINCT dn) AS nb_domain_name ORDER BY nb_domain_name DESC"
"49.1","Easy technical prompt","Find Name nodes directly connected to AS node with asn 109 and return the distinctnames.","MATCH (:AS {asn:109})--(n:Name) RETURN DISTINCT n.name"
"49.2","Easy general prompt","Find all the names of AS109.","MATCH (:AS {asn:109})--(n:Name) RETURN DISTINCT n.name"
"50.1","Easy technical prompt","Find nodes of any type that are connected to the node corresponding to Prefix '1.1.1.0/24'.","MATCH (:Prefix {prefix:'1.1.1.0/24'})--(neighbor) RETURN neighbor"
"50.2","Easy general prompt","Get everything related to prefix '1.1.1.0/24'.","MATCH (:Prefix {prefix:'1.1.1.0/24'})--(neighbor) RETURN neighbor"
"51.1","Easy technical prompt","Get a Country node directly connected to AS with asn 109 and that comes from NRO's delegated stats.","MATCH (:AS {asn:109})-[{reference_name:'nro.delegated_stats'}]-(cc:Country) RETURN cc"
"51.2","Easy general prompt","Find the country of AS109 using the NRO's delegated stats","MATCH (:AS {asn:109})-[{reference_name:'nro.delegated_stats'}]-(cc:Country) RETURN cc"
"52.1","Easy technical prompt","Find the IXP's name and its Country's country_code for IXPs of which the AS with asn 109 is ember of.","MATCH (:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix.name, cc.country_code"
"52.2","Easy general prompt","Get the country codes and names of IXPs where AS109 is present.","MATCH (:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix.name, cc.country_code"
"53.1","Medium technical prompt","Select the HostName nodes in top 50k rankings that resolves to an IP node which is part of a prefix originated by AS with asn 109.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)-[:PART_OF]-(pfx:Prefix)-[:ORIGINATE]-(cisco:AS {asn:109}) WHERE r.rank <= 50000 RETURN dn"
"53.2","Medium general prompt","Get host names in the top 50k hosted by AS109.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)-[:PART_OF]-(pfx:Prefix)-[:ORIGINATE]-(cisco:AS {asn:109}) WHERE r.rank <= 50000 RETURN dn"
"54.1","Medium technical prompt","From the top 10k HostName nodes select HostName nodes that end with '.us' and return the HostName's name, the corresponding IP, prefix, and the AS' asn.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 10000 RETURN dn.name, ip.ip, pfx.prefix, net.asn"
"54.2","Medium general prompt","Get US host names ranked in the top 10k together with their IP, prefix, and ASN.","MATCH (:Ranking)-[r:RANK]-(dn:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 10000 RETURN dn.name, ip.ip, pfx.prefix, net.asn"
"55.1","Medium technical prompt","Select the top 20 AS nodes from Ranking with name 'IHR country ranking: Total AS (RU)' that are in a peer-to-peer relationship and return their asn.","MATCH (a:AS)-[ra:RANK]->(:Ranking {name: 'IHR country ranking: Total AS (RU)'})<-[rb:RANK]-(b:AS)-[p:PEERS_WITH]-(a) WHERE ra.rank <= 20 AND rb.rank <= 20 AND p.rel = 0 RETURN a.asn, b.asn"
"55.2","Medium general prompt","Return ASN pairs for ASes that are in a peer-to-peer relationship and in the top 20 of IHR’s country ranking for Russia.","MATCH (a:AS)-[ra:RANK]->(:Ranking {name: 'IHR country ranking: Total AS (RU)'})<-[rb:RANK]-(b:AS)-[p:PEERS_WITH]-(a) WHERE ra.rank <= 20 AND rb.rank <= 20 AND p.rel = 0 RETURN a.asn, b.asn"
"56.1","Hard technical prompt","Select the  AS nodes for AS node with asn 109 and find the shortest PEERS_WITH relationship to these AS nodes.","MATCH (a:AS {asn:109})-[h:DEPENDS_ON {af:4}]->(d:AS) WITH a, COLLECT(DISTINCT d) AS dependencies UNWIND dependencies as d MATCH p = allShortestPaths((a)-[:PEERS_WITH*]-(d)) WHERE a.asn <> d.asn AND all(r IN relationships(p) WHERE r.af = 4) AND all(n IN nodes(p) WHERE n IN dependencies) RETURN p"
"56.2","Hard general prompt","Retrieve the topology for AS109's dependencies.","MATCH (a:AS {asn:109})-[h:DEPENDS_ON {af:4}]->(d:AS) WITH a, COLLECT(DISTINCT d) AS dependencies UNWIND dependencies as d MATCH p = allShortestPaths((a)-[:PEERS_WITH*]-(d)) WHERE a.asn <> d.asn AND all(r IN relationships(p) WHERE r.af = 4) AND all(n IN nodes(p) WHERE n IN dependencies) RETURN p"
"57.1","Easy technical prompt","Find the Country nodes of IXP nodes of which the AS node with asn 109 is member of. Return both the Country and IXP nodes.","MATCH (cisco:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix, cc"
"57.2","Easy general prompt","Find the geographical footprint of IXPs of which AS109 is a member of.","MATCH (cisco:AS {asn:109})-[:MEMBER_OF]-(ix:IXP)--(cc:Country) RETURN ix, cc"
"58.1","Easy technical prompt","Find the Country nodes of the Facility nodes of the AS node with asn 109. Return both the Country and Facility nodes.","MATCH (cisco:AS {asn:109})--(ix:Facility)--(cc:Country) RETURN ix, cc"
"58.2","Easy general prompt","Get the geographical footprint of facilities at which AS109 is located.","MATCH (cisco:AS {asn:109})--(ix:Facility)--(cc:Country) RETURN ix, cc"
"59.1","Easy technical prompt","Find the Country nodes from the Prefix nodes that originate from AS node with asn 109. Return the Country and Prefix nodes.","MATCH (cisco:AS {asn:109})-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN pfx, cc"
"59.2","Easy general prompt","Get the countries of prefixes announced by AS109 and return the country and prefix nodes.","MATCH (cisco:AS {asn:109})-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN pfx, cc"
"60.1","Medium technical prompt","Find the Country nodes from the Prefix nodes that originate from the AS nodes depending on the AS node with asn 109. Return the AS node of the depending AS, the Prefix nodes, and the Country nodes.","MATCH (cisco:AS {asn:109})<-[:DEPENDS_ON]-(customer:AS)-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN customer, pfx, cc"
"60.2","Medium general prompt","Get the geolocation of prefixes announced by ASes depending on AS109. Return the nodes of the depending ASes, prefixes, and countries.","MATCH (cisco:AS {asn:109})<-[:DEPENDS_ON]-(customer:AS)-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN customer, pfx, cc"
"61.1","Medium technical prompt","Find the ASes that depend on the AS with the asn 109 and the countries in which these ASes originate prefixes. Count the number of distinct depending ASes per country and return the Country's country_code and the count in descending oder.","MATCH (cisco:AS {asn:109})<-[dep:DEPENDS_ON]-(customer:AS)-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN cc.country_code, count(DISTINCT customer) AS nb_dep ORDER BY nb_dep DESC"
"61.2","Medium general prompt","Find in which countries ASes depending on AS109 originate prefixes and count the number of ASes per country. Return the results in descending order.","MATCH (cisco:AS {asn:109})<-[dep:DEPENDS_ON]-(customer:AS)-[:ORIGINATE]-(pfx:Prefix)--(cc:Country) RETURN cc.country_code, count(DISTINCT customer) AS nb_dep ORDER BY nb_dep DESC"
"62.1","Medium technical prompt","Find the DomainName nodes that are ranked in the top 10k and have Prefix nodes originating from the AS node with asn 109. Along with the DomainName nodes, also return the Prefix nodes and the IP nodes.","MATCH (n:AS {asn:109})-[:ORIGINATE]-(p:Prefix)--(i:IP)-[:RESOLVES_TO]-(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 10000 RETURN p,i,d"
"62.2","Medium general prompt","Get domain names in the top 10k hosted by AS109.","MATCH (n:AS {asn:109})-[:ORIGINATE]-(p:Prefix)--(i:IP)-[:RESOLVES_TO]-(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 10000 RETURN DISTINCT d.name"
"63.1","Medium technical prompt","Find the DomainName nodes that are ranked in the top 10k and have Prefix nodes originating from or depending on the AS node with asn 109. Along with the DomainName nodes, also return the Prefix nodes and the IP nodes.","MATCH (n:AS {asn:109})--(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 10000 RETURN p,i,d"
"63.2","Medium general prompt","Get domain names in the top 10k that are related to AS109, including domains that map to prefixes originated by AS109 and prefixes that depend on AS109.","MATCH (n:AS {asn:109})--(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 10000 RETURN p,i,d"
"64.1","Hard technical prompt","Find the AS nodes that are providers of customers of the AS node with asn 8075. Along with these AS nodes, return the corresponding Name nodes, if possible, as specified by the reference_org RIPE NCC and the number of distinct customers. Return the results by descending number of customers.","MATCH (comp:AS)-[:PEERS_WITH {rel:1}]->(customer:AS)<-[:PEERS_WITH {rel:1}]-(microsoft:AS {asn:8075}) WITH comp, customer OPTIONAL MATCH (comp)-[:NAME {reference_org:'RIPE NCC'}]-(comp_name:Name) RETURN comp, comp_name, count(DISTINCT customer) AS nb_customer ORDER BY nb_customer DESC"
"64.2","Hard general prompt","Get the main competitors of AS8075.","MATCH (comp:AS)-[:PEERS_WITH {rel:1}]->(customer:AS)<-[:PEERS_WITH {rel:1}]-(microsoft:AS {asn:8075}) WITH comp, customer OPTIONAL MATCH (comp)-[:NAME {reference_org:'RIPE NCC'}]-(comp_name:Name) RETURN comp, comp_name, count(DISTINCT customer) AS nb_customer ORDER BY nb_customer DESC"
"65.1","Medium technical prompt","Find DomainName nodes that have a ranking below or equal 10k and names ending in '.us'. Along with the DomainName nodes, return the corresponding IP nodes, Prefix nodes, and AS nodes.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 10000 RETURN dn, ip, pfx, net"
"65.2","Medium general prompt","Retrieve domain name, ip, prefix, and AS nodes for the top 10k United States domains.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 10000 RETURN dn, ip, pfx, net"
"66.1","Hard technical prompt","Find DomainName nodes ranked in the top 100k and with name ending with '.us' together with their corresponding AS. If possible, find the names of ASes specified by reference_org RIPE NCC. Return the AS' asn, name and the number of distinct domain names. Order the results by descending number of domains.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 100000 WITH net, dn  OPTIONAL MATCH (net:AS)-[:NAME {reference_org:'RIPE NCC'}]-(net_name:Name) RETURN net.asn, net_name.name, count(DISTINCT dn) AS nb_domain_name ORDER BY nb_domain_name DESC"
"66.2","Hard general prompt","Count the number of United States domains ranked in the top 100k by AS and, if possible, give the AS name specified by RIPE NCC. Return the ASN, AS name and count of domain names in descending order.","MATCH (:Ranking)-[r:RANK]-(dn:DomainName)--(:HostName)--(ip:IP)--(pfx:Prefix)-[:ORIGINATE]-(net:AS) WHERE dn.name ENDS WITH '.us' AND r.rank <= 100000 WITH net, dn  OPTIONAL MATCH (net:AS)-[:NAME {reference_org:'RIPE NCC'}]-(net_name:Name) RETURN net.asn, net_name.name, count(DISTINCT dn) AS nb_domain_name ORDER BY nb_domain_name DESC"
"67.1","Easy technical prompt","Find all nodes that are connected to the Name node with a name containing the word 'osaka'.","MATCH (x)--(n:Name) WHERE toLower(n.name) CONTAINS 'osaka' RETURN x"
"67.2","Easy general prompt","Find all nodes that have the word 'osaka' in their name.","MATCH (x)--(n:Name) WHERE toLower(n.name) CONTAINS 'osaka' RETURN x"
"68.1","Medium technical prompt","Find the DomainName nodes that are ranked in the top 1k and have Prefix nodes originating from the AS node with asn 109. Along with the DomainName nodes, also return the Prefix nodes and the IP nodes.","MATCH (n:AS {asn:109})-[:ORIGINATE]-(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 1000 RETURN p,i,d"
"68.2","Medium general prompt","Get domain names in the top 1k that are hosted by AS109.","MATCH (n:AS {asn:109})-[:ORIGINATE]-(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 1000 RETURN p,i,d"
"69.1","Medium technical prompt","Find the DomainName nodes that are ranked in the top 1k and have Prefix nodes depending on the AS node with asn 109. Along with the DomainName nodes, also return the Prefix nodes and the IP nodes.","MATCH (n:AS {asn:109})-[:DEPENDS_ON]-(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 1000 RETURN p,i,d"
"69.2","Medium general prompt","Get domain names in the top 1k that depend on AS109.","MATCH (n:AS {asn:109})-[:DEPENDS_ON]-(p:Prefix)--(i:IP)--(:HostName)--(d:DomainName)-[r:RANK]-(:Ranking) WHERE r.rank <= 1000 RETURN p,i,d"
"70.1","Hard technical prompt","Find AS nodes that map to the same OpaqueID as the AS node with asn 15735. For these ASes find the originated prefixes containing IPs that resolve to HostName nodes which map to DomainName nodes that are ranked in the top 10k. If possible, also find the names of these ASes as specified by the reference_org RIPE NCC. Return the AS, Prefix, IP, DomainName, and AS name nodes","MATCH (oida:AS {asn: 15735})--(oid:OpaqueID)--(net:AS)--(pfx:Prefix)--(ip:IP)--(:HostName)--(dname:DomainName)-[r]-(:Ranking) OPTIONAL MATCH (net)-[:NAME {reference_org:'RIPE NCC'}]-(asname:Name) WHERE r.rank <= 10000 AND oida <> net RETURN net, pfx, ip, dname, asname"
"70.2","Hard general prompt","Get domain names ranked in the top 10k that are hosted by ASes that map to the same opaque ID as AS15735. If possible, find the AS names as specified by RIPE NCC. Return the AS, prefix, ip, domain name, and AS name nodes.","MATCH (oida:AS {asn: 15735})--(oid:OpaqueID)--(net:AS)--(pfx:Prefix)--(ip:IP)--(:HostName)--(dname:DomainName)-[r]-(:Ranking) OPTIONAL MATCH (net)-[:NAME {reference_org:'RIPE NCC'}]-(asname:Name) WHERE r.rank <= 10000 AND oida <> net RETURN net, pfx, ip, dname, asname"
"71.1","Hard technical prompt","Find AS nodes that map to the same OpaqueID as the AS node with asn 15735 and get the Prefix nodes originated by these ASes with the Country nodes of the prefixes. If possible, get the Name node for the AS as specified by reference_org RIPE NCC. Return AS, Prefix, Name, Country, and OpaqueID nodes for prefixes not located in the Country with country_code 'MT'.","MATCH (:AS {asn:15735})--(oid:OpaqueID)--(net:AS)--(pfx:Prefix)--(cc:Country) OPTIONAL MATCH (net)-[:NAME {reference_org:'RIPE NCC'}]-(asname:Name) WHERE net.asn<>15735 AND cc.country_code <> 'MT' RETURN net, pfx, asname, cc, oid"
"71.2","Hard general prompt","Find the prefixes that are not located in Malta and are originated by ASes mapping to the same opaque ID as AS15735. If possible, get the AS names as specified by RIPE NCC. Return the AS, prefix, name, conutry, and opaque ID nodes.","MATCH (:AS {asn:15735})--(oid:OpaqueID)--(net:AS)--(pfx:Prefix)--(cc:Country) OPTIONAL MATCH (net)-[:NAME {reference_org:'RIPE NCC'}]-(asname:Name) WHERE net.asn<>15735 AND cc.country_code <> 'MT' RETURN net, pfx, asname, cc, oid"
"72.1","Easy technical prompt","Find all the IXP nodes that are connected with AS nodes that map to the same OpaqueID as the AS nodes with asn 6799. Also return the AS nodes.","MATCH (:AS {asn: 6799})--(oid:OpaqueID)--(n:AS)--(ix:IXP) RETURN n, ix"
"72.2","Easy general prompt","Find IXP nodes connected to ASes that map to the same opaque ID as AS6799. Return the IXP and AS nodes.","MATCH (:AS {asn: 6799})--(oid:OpaqueID)--(n:AS)--(ix:IXP) RETURN n, ix"
"73.1","Easy technical prompt","Find all the Country nodes of the IXP nodes that are connected with AS node with asn 6799. Return the IXP and Country nodes.","MATCH (n:AS {asn:6799})--(ix:IXP)--(cc:Country) RETURN ix,cc"
"73.2","Easy general prompt","Get the countries of IXPs of which AS6799 is a member of. Return the IXP and country nodes.","MATCH (n:AS {asn:6799})--(ix:IXP)--(cc:Country) RETURN ix,cc"
"74.1","Hard technical prompt","Find DomainName nodes with name ending in '.mt' that are ranked in the top 10k. Find the Country nodes as specified by reference_org NRO of ASes that originate Prefixes that host these DomainNames. Return the number of distinct DomainNames per country in descending order.","MATCH (:Ranking)-[r:RANK]-(domain:DomainName)--(:HostName)--(:IP)--(:Prefix)-[:ORIGINATE]-(:AS)-[:COUNTRY {reference_org:'NRO'}]-(cc:Country) WHERE r.rank <= 10000 AND domain.name ENDS WITH '.mt' RETURN cc.country_code, count(DISTINCT domain.name) AS dm_count ORDER BY dm_count DESC"
"74.2","Hard general prompt","Get the country registration of ASes hosting Maltese domain names in the top 10k. Return the number of domains per country in descending order.","MATCH (:Ranking)-[r:RANK]-(domain:DomainName)--(:HostName)--(:IP)--(:Prefix)-[:ORIGINATE]-(:AS)-[:COUNTRY {reference_org:'NRO'}]-(cc:Country) WHERE r.rank <= 10000 AND domain.name ENDS WITH '.mt' RETURN cc.country_code, count(DISTINCT domain.name) AS dm_count ORDER BY dm_count DESC"
"75.1","Easy technical prompt","Find the total number of distinct AS in the Country with country_code 'US' as specified by the reference_org NRO.","MATCH (a:AS)-[:COUNTRY {reference_org:'NRO'}]-(:Country {country_code:'US'}) RETURN COUNT(DISTINCT a)"
"75.2","Easy general prompt","Get the number of ASes registered in the United States.","MATCH (a:AS)-[:COUNTRY {reference_org:'NRO'}]-(:Country {country_code:'US'}) RETURN COUNT(DISTINCT a)"
"76.1","Hard technical prompt","Find the AS nodes associated with the country code 'US' through the COUNTRY relationship using the reference organization 'RIPE NCC'. Match these AS nodes to Ranking nodes with a rank below 10 according to the 'ihr.country_dependency' reference. Optionally, match the AS nodes with their corresponding Name nodes using the 'BGP.Tools' reference. Return the ASNs, their corresponding AS names, and a collection of the ranking names, ordered by ASN.","MATCH (a:AS)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(r:Ranking)--(:Country {country_code:'US'}) WHERE ra.rank < 10 OPTIONAL MATCH (a)-[:NAME {reference_org:""BGP.Tools""}]-(n:Name) RETURN DISTINCT a.asn as ASN, n.name AS AS_Name, COLLECT(r.name) as Rankings ORDER BY a.asn"
"76.2","Hard general prompt","Find ASes located in the United States as specified by RIPE NCC that are in the top 9 of the US country dependency ranking. If possible find the AS names specified by BGP.Tools and return the ASN, AS name and ranking names ordered by ASN.","MATCH (a:AS)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(r:Ranking)--(:Country {country_code:'US'}) WHERE ra.rank < 10 OPTIONAL MATCH (a)-[:NAME {reference_org:""BGP.Tools""}]-(n:Name) RETURN DISTINCT a.asn as ASN, n.name AS AS_Name, COLLECT(r.name) as Rankings ORDER BY a.asn"
"77.1","Hard technical prompt","Find the AS nodes associated with the country code 'US' through the COUNTRY relationship using the reference organization 'RIPE NCC'. Match these AS nodes to Ranking relationships with a rank below 10 according to the 'ihr.country_dependency' reference. Optionally, match the AS nodes to other AS nodes with which they have a PEERS_WITH relationship (with 'rel' equal to 1) and a DEPENDS_ON relationship (with 'hege' greater than 0.03). Ensure the AS nodes are different from each other. Return the AS nodes, the DEPENDS_ON relationships, and the peer AS nodes.","MATCH (a:AS)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(:Ranking) WHERE ra.rank < 10 OPTIONAL MATCH (a)-[p:PEERS_WITH]-(b), (a)-[d:DEPENDS_ON]->(b) WHERE p.rel = 1 AND d.hege > 0.03 AND a<>b RETURN a, d, b"
"77.2","Hard general prompt","Find ASes located in the United States as specified by RIPE NCC that are in the top 9 of the US country dependency ranking. If possible find customer ASes that have a dependency of more than 0.03 and return the AS and dependency relationship nodes.","MATCH (a:AS)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(:Ranking) WHERE ra.rank < 10 OPTIONAL MATCH (a)-[p:PEERS_WITH]-(b), (a)-[d:DEPENDS_ON]->(b) WHERE p.rel = 1 AND d.hege > 0.03 AND a<>b RETURN a, d, b"
"78.1","Hard technical prompt","Find the AS nodes associated with the country code 'US' through the COUNTRY relationship using the reference organization 'RIPE NCC'. Match these AS nodes to Ranking relationships with a rank of 10 or below according to the 'ihr.country_dependency' reference. Optionally, match the AS nodes to IXP nodes through the MEMBER_OF relationship, ensuring these IXP nodes are also associated with the country code 'US'. Return the AS nodes, the MEMBER_OF relationships, and the IXP nodes.","MATCH (a)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a:AS)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(:Ranking) WHERE ra.rank <= 10 OPTIONAL MATCH (a)-[m:MEMBER_OF]-(ix:IXP)-[:COUNTRY]-(:Country {country_code:'US'}) RETURN a, m, ix"
"78.2","Hard general prompt","Find ASes located in the United States as specified by RIPE NCC that are in the top 10 of the US country dependency ranking. If possible find IXPs in the US where these ASes are members. Return the AS and IXP nodes and the member relationship.","MATCH (a)-[:COUNTRY {reference_org:'RIPE NCC'}]-(:Country {country_code:'US'}) MATCH (a:AS)-[ra:RANK {reference_name:'ihr.country_dependency'}]->(:Ranking) WHERE ra.rank <= 10 OPTIONAL MATCH (a)-[m:MEMBER_OF]-(ix:IXP)-[:COUNTRY]-(:Country {country_code:'US'}) RETURN a, m, ix"
"79.1","Medium technical prompt","Find the DomainName nodes that are ranked in the 'Tranco top 1M' ranking. These DomainName nodes should have been queried more than 30 times from the country with the country code 'US'. Return the domain names, their ranks, and the number of queries from the US, ordered by rank.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'US' RETURN dn.name as domain_name, ra.rank as rank, q.value as per_query_US ORDER BY rank"
"79.2","Medium general prompt","Get domain names in the Tranco top 1M list that where queried more than 30 times from the United States and return their name, rank, and number of queries ordered by rank.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'US' RETURN dn.name as domain_name, ra.rank as rank, q.value as per_query_US ORDER BY rank"
"80.1","Medium technical prompt","Find the path for the DomainName node with the name 'yahoo.com'. This path includes connections to HostName, IP, Prefix nodes, and an ORIGINATE relationship (with 'BGPKIT' as the reference organization) to an AS node. Return the entire path.","MATCH p = (dn:DomainName)--(:HostName)--(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) WHERE dn.name = 'yahoo.com' RETURN p"
"80.2","Medium general prompt","Get a graph of IP addresses, prefixes, and ASNs related to yahoo.com.","MATCH p = (dn:DomainName)--(:HostName)--(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) WHERE dn.name = 'yahoo.com' RETURN p"
"81.1","Hard technical prompt","Find the DomainName nodes that are ranked in the 'Tranco top 1M' ranking with a rank below or equal 10,000. These DomainName nodes should have been queried more than 30 times from the country with the country code 'LU'. Match these DomainName nodes to HostName nodes that resolve to IP nodes, which are part of Prefix nodes, originating from AS nodes. Return a path connecting the DomainName,HostName, IP, Prefix, and AS nodes.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'LU' AND ra.rank <= 10000 MATCH path = (dn)--(:HostName)-[r:RESOLVES_TO]-(ip:IP)-[p:PART_OF]-(pfx:Prefix)-[o:ORIGINATE]-(net:AS) RETURN path"
"81.2","Hard general prompt","Show a domain-to-AS graph for domains in the top 10k of the Tranco top 1M list that were queried more than 30 times from Luxembourg.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'LU' AND ra.rank <= 10000 MATCH path = (dn)--(:HostName)-[r:RESOLVES_TO]-(ip:IP)-[p:PART_OF]-(pfx:Prefix)-[o:ORIGINATE]-(net:AS) RETURN path"
"82.1","Hard technical prompt","Find the DomainName nodes that are ranked in the 'Tranco top 1M' ranking with a rank below or equal 10,000. These DomainName nodes should have been queried more than 30 times from the country with the country code 'LU'. Match these DomainName nodes to AuthoritativeNameServer nodes through the MANAGED_BY relationship, which resolve to IP nodes. These IP nodes should be part of Prefix nodes that originate from AS nodes with 'BGPKIT' as the reference organization. Return for each domain name, the number of distinct AS nodes, and a collection of the distinct ASNs, ordered by the number of AS nodes in descending order.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'LU' AND ra.rank <= 10000 MATCH (dn)-[:MANAGED_BY]-(:AuthoritativeNameServer)-[:RESOLVES_TO]-(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) RETURN dn.name, count(DISTINCT a) AS nb_asn, COLLECT(distinct a.asn) ORDER BY nb_asn DESC"
"82.2","Hard general prompt","Find domain names in the top 10k of the Tranco top 1M list that were queried more than 30 times from Luxembourg. Then find the ASes that host the name servers which manage these domains. Return for each domain the number of ASes as well as a set of the ASNs, order by descending number of ASes.","MATCH (:Ranking {name: 'Tranco top 1M'})-[ra:RANK]-(dn:DomainName)-[q:QUERIED_FROM]-(c:Country) WHERE q.value > 30 AND c.country_code = 'LU' AND ra.rank <= 10000 MATCH (dn)-[:MANAGED_BY]-(:AuthoritativeNameServer)-[:RESOLVES_TO]-(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) RETURN dn.name, count(DISTINCT a) AS nb_asn, COLLECT(distinct a.asn) ORDER BY nb_asn DESC"
"83.1","Hard technical prompt","Find the path for the DomainName node with the name 'google.com'. This path includes connections to AuthoritativeNameServer nodes through the MANAGED_BY relationship, which resolve to IP nodes. These IP nodes are part of Prefix nodes that originate from AS nodes with 'BGPKIT' as the reference organization. Return the entire path.","MATCH p = (dn:DomainName)-[:MANAGED_BY]-(:AuthoritativeNameServer)-[:RESOLVES_TO]-(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) WHERE dn.name = 'google.com' RETURN p"
"83.2","Hard general prompt","Get a graph showing the authoritative DNS name servers and their hosting ASes for google.com.","MATCH p = (dn:DomainName)-[:MANAGED_BY]-(:AuthoritativeNameServer)-[:RESOLVES_TO]-(:IP)-[:PART_OF]-(:Prefix)-[:ORIGINATE {reference_org:'BGPKIT'}]-(a:AS) WHERE dn.name = 'google.com' RETURN p"